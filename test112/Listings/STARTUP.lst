A51 MACRO ASSEMBLER  STARTUP                                                              10/29/2023 16:30:48 PAGE     1


MACRO ASSEMBLER A51 V8.2.7.0
OBJECT MODULE PLACED IN .\Objects\STARTUP.obj
ASSEMBLER INVOKED BY: C:\Keil_v5\C51\BIN\A51.EXE STARTUP.A51 SET(SMALL) DEBUG PRINT(.\Listings\STARTUP.lst) OBJECT(.\Obj
                      ects\STARTUP.obj) EP

LOC  OBJ            LINE     SOURCE

0000                   1     ORG     0x00
0000 802E              2     JMP     INIT
0003                   3     ORG     0x03
0003 2160              4     JMP     INT0_ISR
0030                   5     ORG     0x30
0030                   6     INIT:
0030 D2B2              7                     SETB P3.2
0032 75A881            8                     MOV     IE, #0x81       
0035 758131            9                     MOV     SP, #0x31
0038 D288             10                     SETB IT0
003A D2D3             11                     SETB RS0
003C 7800             12                     MOV     R0, #0
003E 7900             13                     MOV     R1, #0
0040 7A00             14                     MOV     R2, #0
0042 C2D3             15                     CLR     RS0
0044 D200             16                     SETB 0x00
0046                  17     MAIN:
0046 C2D3             18                     CLR     RS0
0048 7800             19                     MOV     R0, #0
004A 7904             20                     MOV     R1, #4
004C 7AF7             21                     MOV     R2, #0xF7
004E                  22     SCAN:                   
004E D2B3             23                     SETB P3.3
0050 EA               24                     MOV     A, R2
0051 F5A0             25                     MOV     P2, A
0053 30B36B           26                     JNB     P3.3, EQUAL
0056 30A715           27                     JNB     P2.7, KEY_IN
0059 08               28                     INC     R0
005A 30A611           29                     JNB     P2.6, KEY_IN
005D 08               30                     INC     R0
005E 30A50D           31                     JNB     P2.5, KEY_IN
0061 08               32                     INC     R0
0062 30A409           33                     JNB     P2.4, KEY_IN
0065 08               34                     INC     R0
0066 03               35                     RR A
0067 FA               36                     MOV     R2, A
0068 D9E4             37                     DJNZ R1, SCAN
006A                  38     KEY_OUT:
006A 3137             39                     CALL    DISPLAY                 
006C 80D8             40                     SJMP    MAIN
006E                  41     KEY_IN:                 
006E 312A             42                     CALL DEBOUNCE
0070 90018A           43                     MOV     DPTR, #KB_table
0073 E8               44                     MOV     A, R0
0074 93               45                     MOVC A, @A+DPTR
0075 B40A02           46                     CJNE A, #0x0A, NEXT1
0078 8039             47                     SJMP OP_IN
007A                  48     NEXT1:
007A B40B02           49                     CJNE A, #0x0B, NEXT2
007D 8034             50                     SJMP OP_IN
007F                  51     NEXT2:
007F B40C02           52                     CJNE A, #0x0C, NEXT3
0082 802F             53                     SJMP OP_IN
0084                  54     NEXT3:
0084 B40D02           55                     CJNE A, #0x0D, NEXT4
0087 802A             56                     SJMP OP_IN
0089                  57     NEXT4:
A51 MACRO ASSEMBLER  STARTUP                                                              10/29/2023 16:30:48 PAGE     2

0089 B40E02           58                     CJNE A, #0x0E, NEXT5
008C 8007             59                     SJMP L_BRACKETS
008E                  60     NEXT5:
008E B40F02           61                     CJNE A, #0x0F, NEXT6
0091 800C             62                     SJMP R_BRACKETS
0093                  63     NEXT6:
0093 803B             64                     SJMP SAVE_IN
0095                  65     L_BRACKETS:
0095 D2D3             66                     SETB RS0
0097 7800             67                     MOV     R0, #0
0099 7900             68                     MOV     R1, #0
009B 7A00             69                     MOV     R2, #0
009D 80CB             70                     JMP     KEY_OUT
009F                  71     R_BRACKETS:
009F D2D3             72                     SETB RS0
00A1 D00E             73                     POP     0x0E
00A3 D00D             74                     POP     0x0D
00A5 D00C             75                     POP     0x0C
00A7 3108             76                     CALL CAL
00A9 C00B             77                     PUSH 0x0B
00AB 7800             78                     MOV     R0, #0                  
00AD 7900             79                     MOV     R1, #0                  
00AF 7A00             80                     MOV     R2, #0                  
00B1 80B7             81                     JMP     KEY_OUT
00B3                  82     OP_IN:
00B3 D2D3             83                     SETB RS0
00B5 C0E0             84                     PUSH 0xE0
00B7 C200             85                     CLR     0x00
00B9 7800             86                     MOV     R0, #0
00BB 7900             87                     MOV     R1, #0
00BD 7A00             88                     MOV     R2, #0
00BF 80A9             89                     JMP     KEY_OUT
00C1                  90     EQUAL:
00C1 312A             91                     CALL DEBOUNCE
00C3 D2D3             92                     SETB RS0
00C5 E581             93                     MOV     A, SP
00C7 B43132           94                     CJNE A, #0x31, POP_CAL
00CA D00B             95                     POP     0x0B
00CC 3172             96                     CALL SET_DEGITS
00CE 809A             97                     JMP     KEY_OUT
                      98     
00D0                  99     SAVE_IN:
00D0 D2D3            100                     SETB RS0
00D2 FF              101                     MOV     R7, A
00D3 E9              102                     MOV     A, R1
00D4 F8              103                     MOV     R0, A
00D5 EA              104                     MOV     A, R2
00D6 F9              105                     MOV     R1, A
00D7 EF              106                     MOV     A, R7
00D8 FA              107                     MOV     R2, A
00D9 E8              108                     MOV     A, R0
00DA 75F064          109                     MOV     B, #100
00DD A4              110                     MUL     AB
00DE FB              111                     MOV     R3, A
00DF E9              112                     MOV     A, R1
00E0 75F00A          113                     MOV     B, #10
00E3 A4              114                     MUL     AB
00E4 8BF0            115                     MOV     B, R3
00E6 25F0            116                     ADD     A, B
00E8 8AF0            117                     MOV     B, R2
00EA 25F0            118                     ADD     A, B
00EC FB              119                     MOV     R3, A
00ED 300006          120                     JNB     0x00, SKIP_REFRESH
00F0 E581            121                     MOV     A, SP
00F2 9401            122                     SUBB A, #0x01
00F4 F581            123                     MOV     SP, A
A51 MACRO ASSEMBLER  STARTUP                                                              10/29/2023 16:30:48 PAGE     3

00F6                 124     SKIP_REFRESH:   
00F6 C00B            125                     PUSH 0x0B
00F8 D200            126                     SETB 0x00
00FA 016A            127                     JMP     KEY_OUT
00FC                 128     POP_CAL:                
00FC D00E            129                     POP     0x0E
00FE D00D            130                     POP     0x0D
0100 D00C            131                     POP     0x0C
0102 3108            132                     CALL CAL
0104 C00B            133                     PUSH 0x0B
0106 016A            134                     JMP     KEY_OUT
0108                 135     CAL:
0108 EC              136                     MOV     A, R4
0109 8EF0            137                     MOV     B, R6
010B BD0A06          138                     CJNE R5, #0x0A, SUB_CAL
010E 25F0            139                     ADD     A, B
0110 FB              140                     MOV     R3, A
0111 3172            141                     CALL SET_DEGITS
0113 22              142                     RET
0114                 143     SUB_CAL:
0114 BD0B06          144                     CJNE R5, #0x0B, MUL_CAL
0117 95F0            145                     SUBB A, B
0119 FB              146                     MOV     R3, A
011A 3172            147                     CALL SET_DEGITS
011C 22              148                     RET
011D                 149     MUL_CAL:
011D BD0C05          150                     CJNE R5, #0x0C, DIV_CAL
0120 A4              151                     MUL     AB
0121 FB              152                     MOV     R3, A
0122 3172            153                     CALL SET_DEGITS
0124 22              154                     RET
0125                 155     DIV_CAL:
0125 84              156                     DIV     AB
0126 FB              157                     MOV     R3, A   
0127 3172            158                     CALL SET_DEGITS
0129 22              159                     RET
012A 7D03            160     DEBOUNCE:               MOV     R5, #3                                  
012C 7EC8            161     DEL_100_MS:             MOV     R6, #200                                
012E 7FFA            162     DEL_500_US:             MOV     R7, #250                                
0130 DFFE            163                                     DJNZ    R7, $                           
0132 DEFA            164                                     DJNZ    R6, DEL_500_US          
0134 DDF6            165                                     DJNZ    R5, DEL_100_MS          
0136 22              166                                     RET                                             
                     167                                     
0137 90019A          168     DISPLAY:                MOV     DPTR, #DP_table         
013A D2D3            169                                     SETB    RS0                             
013C C2B5            170                                     CLR     P3.5                            
013E E8              171                                     MOV     A, R0                           
013F 93              172                                     MOVC    A, @A+DPTR              
0140 F590            173                                     MOV     P1, A                           
0142 315B            174                                     CALL    DEL_300_US              
0144 D2B5            175                                     SETB    P3.5                    
0146 C2B6            176                                     CLR     P3.6                            
0148 E9              177                                     MOV     A, R1                           
0149 93              178                                     MOVC    A, @A+DPTR              
014A F590            179                                     MOV     P1, A                           
014C 315B            180                                     CALL    DEL_300_US              
014E D2B6            181                                     SETB    P3.6                    
0150 C2B7            182                                     CLR     P3.7                            
0152 EA              183                                     MOV     A, R2                           
0153 93              184                                     MOVC    A, @A+DPTR              
0154 F590            185                                     MOV     P1, A                           
0156 315B            186                                     CALL    DEL_300_US              
0158 D2B7            187                                     SETB    P3.7
015A 22              188                                     RET                                     
                     189     
A51 MACRO ASSEMBLER  STARTUP                                                              10/29/2023 16:30:48 PAGE     4

015B 7FA4            190     DEL_300_US:             MOV     R7, #164                        
015D DFFE            191                             DJNZ    R7, $
015F 22              192                             RET
                     193     
0160 D2D3            194     INT0_ISR:               SETB    RS0                                     
0162 D2B2            195                                     SETB P3.2
0164 3172            196     COUNTDOWN:              CALL    SET_DEGITS                      
0166 7D0A            197                                     MOV     R5, #10                                 
0168 3181            198                                     CALL    SHOW                            
016A DBF8            199                                     DJNZ    R3, COUNTDOWN   
016C 3172            200                                     CALL    SET_DEGITS      
016E 3181            201     STOP1:                  CALL    SHOW    
0170 80FC            202                                     SJMP STOP1
                     203                                     
0172 EB              204     SET_DEGITS:             MOV     A, R3           
0173 75F00A          205                                     MOV     B, #10          
0176 84              206                                     DIV     AB                      
0177 AAF0            207                                     MOV     R2, B           
0179 75F00A          208                                     MOV     B, #10          
017C 84              209                                     DIV     AB                      
017D A9F0            210                                     MOV     R1, B           
017F F8              211                                     MOV     R0, A           
0180 22              212                                     RET                             
                     213     
0181 7E64            214     SHOW:                   MOV     R6, #100        
0183 3137            215     SHOW1:                  CALL    DISPLAY
0185 DEFC            216                             DJNZ    R6, SHOW1
0187 DDF8            217                             DJNZ    R5, SHOW
0189 22              218                             RET
                     219     
018A 01              220     KB_table:               DB              01H             
018B 02              221                                     DB              02H             
018C 03              222                                     DB              03H             
018D 0A              223                                     DB              0AH             
018E 04              224                                     DB              04H             
018F 05              225                                     DB              05H             
0190 06              226                                     DB              06H             
0191 0B              227                                     DB              0BH             
0192 07              228                                     DB              07H             
0193 08              229                                     DB              08H             
0194 09              230                                     DB              09H             
0195 0C              231                                     DB              0CH             
0196 0E              232                                     DB              0EH             
0197 00              233                                     DB              00H             
0198 0F              234                                     DB              0FH             
0199 0D              235                                     DB              0DH             
                     236                                     
019A                 237     DP_table:
019A 03              238                     DB 00000011B ; 0
019B 9F              239                     DB 10011111B ; display "1"
019C 25              240                     DB 00100101B ; display "2"
019D 0D              241                     DB 00001101B ; display "3"
019E 99              242                     DB 10011001B ; display "4"
019F 49              243                     DB 01001001B ; display "5"
01A0 41              244                     DB 01000001B ; display "6"
01A1 1B              245                     DB 00011011B ; display "7"
01A2 01              246                     DB 00000001B ; display "8"
01A3 19              247                     DB 00011001B ; display "9"
                     248                     
                     249     END
A51 MACRO ASSEMBLER  STARTUP                                                              10/29/2023 16:30:48 PAGE     5

SYMBOL TABLE LISTING
------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES

B. . . . . . . . .  D ADDR   00F0H   A   
CAL. . . . . . . .  C ADDR   0108H   A   
COUNTDOWN. . . . .  C ADDR   0164H   A   
DEBOUNCE . . . . .  C ADDR   012AH   A   
DEL_100_MS . . . .  C ADDR   012CH   A   
DEL_300_US . . . .  C ADDR   015BH   A   
DEL_500_US . . . .  C ADDR   012EH   A   
DISPLAY. . . . . .  C ADDR   0137H   A   
DIV_CAL. . . . . .  C ADDR   0125H   A   
DP_TABLE . . . . .  C ADDR   019AH   A   
EQUAL. . . . . . .  C ADDR   00C1H   A   
IE . . . . . . . .  D ADDR   00A8H   A   
INIT . . . . . . .  C ADDR   0030H   A   
INT0_ISR . . . . .  C ADDR   0160H   A   
IT0. . . . . . . .  B ADDR   0088H.0 A   
KB_TABLE . . . . .  C ADDR   018AH   A   
KEY_IN . . . . . .  C ADDR   006EH   A   
KEY_OUT. . . . . .  C ADDR   006AH   A   
L_BRACKETS . . . .  C ADDR   0095H   A   
MAIN . . . . . . .  C ADDR   0046H   A   
MUL_CAL. . . . . .  C ADDR   011DH   A   
NEXT1. . . . . . .  C ADDR   007AH   A   
NEXT2. . . . . . .  C ADDR   007FH   A   
NEXT3. . . . . . .  C ADDR   0084H   A   
NEXT4. . . . . . .  C ADDR   0089H   A   
NEXT5. . . . . . .  C ADDR   008EH   A   
NEXT6. . . . . . .  C ADDR   0093H   A   
OP_IN. . . . . . .  C ADDR   00B3H   A   
P1 . . . . . . . .  D ADDR   0090H   A   
P2 . . . . . . . .  D ADDR   00A0H   A   
P3 . . . . . . . .  D ADDR   00B0H   A   
POP_CAL. . . . . .  C ADDR   00FCH   A   
RS0. . . . . . . .  B ADDR   00D0H.3 A   
R_BRACKETS . . . .  C ADDR   009FH   A   
SAVE_IN. . . . . .  C ADDR   00D0H   A   
SCAN . . . . . . .  C ADDR   004EH   A   
SET_DEGITS . . . .  C ADDR   0172H   A   
SHOW . . . . . . .  C ADDR   0181H   A   
SHOW1. . . . . . .  C ADDR   0183H   A   
SKIP_REFRESH . . .  C ADDR   00F6H   A   
SP . . . . . . . .  D ADDR   0081H   A   
STOP1. . . . . . .  C ADDR   016EH   A   
SUB_CAL. . . . . .  C ADDR   0114H   A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
